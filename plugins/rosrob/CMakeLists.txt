cmake_minimum_required (VERSION 2.6)
include (../../wbc.cmake)

### This plugin only works if you have ROS...

if (NOT TRY_ROS)
  set (TRY_ROS true)
endif (NOT TRY_ROS)
if (TRY_ROS)
  if (NOT $ENV{ROS_ROOT} STREQUAL "")
    if (NOT EXISTS $ENV{ROS_ROOT}/core/rosbuild/rosbuild.cmake)
      message ("[rosrob plugin] WARNING ROS_ROOT is set but rosbuild.cmake not found")
    else (NOT EXISTS $ENV{ROS_ROOT}/core/rosbuild/rosbuild.cmake)
      include ($ENV{ROS_ROOT}/core/rosbuild/rosbuild.cmake)
      rosbuild_find_ros_package (sensor_msgs)
      if (${sensor_msgs_PACKAGE_PATH} STREQUAL "")
	message ("[rosrob plugin] WARNING sensor_msgs ROS package not found")
      else (${sensor_msgs_PACKAGE_PATH} STREQUAL "")
	message ("[rosrob plugin] Yeah, found sensor_msgs ROS package")
	rosbuild_invoke_rospack (sensor_msgs playtao temp cflags-only-I)
	include_directories (${playtao_temp})
	rosbuild_invoke_rospack (sensor_msgs playtao temp cflags-only-other)
	add_definitions (${playtao_temp})
	rosbuild_invoke_rospack (sensor_msgs playtao temp libs-only-L)
	link_directories (${playtao_temp})
	rosbuild_invoke_rospack (sensor_msgs playtao temp libs-only-l)
	list (APPEND LIBS ${playtao_temp})
	wbc_add_plugin (rosrob plugin.cpp Robot.cpp)
      endif (${sensor_msgs_PACKAGE_PATH} STREQUAL "")
    endif (NOT EXISTS $ENV{ROS_ROOT}/core/rosbuild/rosbuild.cmake)
  endif (NOT $ENV{ROS_ROOT} STREQUAL "")
endif (TRY_ROS)
